@implements IDisposable
@inject StateContainer StateContainer

<MudDatePicker
    PickerVariant="PickerVariant.Static"
    AdditionalDateClassesFunc="CheckDate"
    @bind-Date="selectedDateTime"
/>

@code {
    [Parameter]
    public IEnumerable<DateOnly> Dates { get; set; }

    protected override void OnInitialized()
    {
        StateContainer.OnChange += StateHasChanged;
    }

    private DateTime? selectedDateTime
    {
        get
        {
            return StateContainer.SelectedDate.ToDateTime(TimeOnly.MinValue);
        }
        set
        {
            StateContainer.SelectedDate = DateOnly.FromDateTime(value ?? DateTime.Today);
        }
    }

    private string CheckDate(DateTime date)
    {
        return Dates.Contains(DateOnly.FromDateTime(date)) ? "selected-day" : string.Empty;
    }


    public void Dispose()
    {
        StateContainer.OnChange -= StateHasChanged;
    }
}
